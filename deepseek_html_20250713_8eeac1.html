<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Malla Curricular - Ingeniería Informática (57 Ramos)</title>
  <style>
    :root {
      --color-aprobado: #C8A2C8;  /* Morado pastel */
      --color-cursando: #FFB6C1;  /* Rosa claro */
      --color-pendiente: #D8BFD8; /* Lila pastel */
      --color-bloqueado: #E6E6FA; /* Lavanda */
      --color-fondo: #FFF0F5;     /* Rosa muy claro */
      --color-cabecera: #9370DB;  /* Morado medio */
      --color-texto: #4B0082;     /* Índigo para contraste */
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background: var(--color-fondo);
      color: var(--color-texto);
    }
    
    h1 {
      text-align: center;
      color: var(--color-texto);
      margin-bottom: 30px;
    }
    
    .semestre {
      margin-bottom: 30px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    
    .semestre-header {
      background: var(--color-cabecera);
      color: white;
      padding: 10px 15px;
      font-weight: bold;
      font-size: 1.2em;
    }
    
    .malla-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 15px;
      padding: 15px;
    }
    
    .asignatura {
      border-radius: 5px;
      padding: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      position: relative;
      transition: all 0.3s ease;
      background: white;
    }
    
    .asignatura h3 {
      margin: 0 0 5px 0;
      font-size: 16px;
    }
    
    .asignatura p {
      margin: 5px 0;
      font-size: 14px;
    }
    
    .creditos {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(0,0,0,0.05);
      border-radius: 3px;
      padding: 2px 5px;
      font-size: 12px;
    }
    
    .prerequisitos {
      font-size: 12px;
      color: #666;
      margin-top: 10px;
      padding-top: 5px;
      border-top: 1px dashed #ddd;
    }
    
    .estado-botones {
      display: flex;
      gap: 5px;
      margin-top: 10px;
    }
    
    .estado-btn {
      border: none;
      padding: 5px 8px;
      border-radius: 3px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.2s;
      flex-grow: 1;
      color: white;
    }
    
    .aprobado {
      background-color: #F0E6FF;
      border-left: 4px solid var(--color-aprobado);
    }
    
    .cursando {
      background-color: #FFEEF6;
      border-left: 4px solid var(--color-cursando);
    }
    
    .pendiente {
      background-color: #F5E6FF;
      border-left: 4px solid var(--color-pendiente);
    }
    
    .bloqueado {
      background-color: #FAF0FF;
      border-left: 4px solid var(--color-bloqueado);
      color: #9B72CF;
    }
    
    .bloqueado h3, .bloqueado p {
      color: #9B72CF;
    }
    
    .btn-aprobado {
      background-color: var(--color-aprobado);
    }
    
    .btn-cursando {
      background-color: var(--color-cursando);
    }
    
    .btn-pendiente {
      background-color: var(--color-pendiente);
    }
    
    .progreso-container {
      width: 100%;
      max-width: 800px;
      margin: 20px auto;
      background: #E6E6FA;
      border-radius: 10px;
      height: 20px;
      overflow: hidden;
    }
    
    .progreso-bar {
      height: 100%;
      background: linear-gradient(90deg, #C8A2C8, #9370DB);
      width: 0%;
      transition: width 0.5s ease;
    }
    
    .estadisticas {
      text-align: center;
      margin: 20px 0;
      font-size: 18px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .estadistica-item {
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .leyenda {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    .leyenda-item {
      display: flex;
      align-items: center;
      font-size: 14px;
    }
    
    .leyenda-color {
      width: 20px;
      height: 20px;
      border-radius: 3px;
      margin-right: 5px;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Ingeniería Informática</h1>
  
  <div class="leyenda">
    <div class="leyenda-item">
      <div class="leyenda-color" style="background-color: var(--color-aprobado);"></div>
      <span>Aprobado</span>
    </div>
    <div class="leyenda-item">
      <div class="leyenda-color" style="background-color: var(--color-cursando);"></div>
      <span>Cursando</span>
    </div>
    <div class="leyenda-item">
      <div class="leyenda-color" style="background-color: var(--color-pendiente);"></div>
      <span>Pendiente</span>
    </div>
    <div class="leyenda-item">
      <div class="leyenda-color" style="background-color: var(--color-bloqueado);"></div>
      <span>Bloqueado</span>
    </div>
  </div>
  
  <div class="estadisticas">
    <div class="estadistica-item">
      <div>Progreso de la carrera</div>
      <div class="progreso-container">
        <div class="progreso-bar" id="progreso-bar"></div>
      </div>
      <div id="progreso-texto">0% completado</div>
    </div>
    
    <div class="estadistica-item">
      <div id="asignaturas-totales">Total asignaturas: 57</div>
      <div id="asignaturas-aprobadas">Aprobadas: 0 (0%)</div>
    </div>
    
    <div class="estadistica-item">
      <div id="creditos-totales">Créditos totales: 300</div>
      <div id="creditos-aprobados">Aprobados: 0 (0%)</div>
    </div>
  </div>
  
  <div id="malla-container"></div>

  <script>
    const mallaCompleta = [
      // Semestre 1 (30 créditos - 6 ramos)
      { sigla: "MAT060", nombre: "ÁLGEBRA Y GEOMETRÍA", semestre: 1, creditos: 6, prerequisitos: [] },
      { sigla: "HXW006", nombre: "COMUNICACIÓN EFECTIVA I", semestre: 1, creditos: 3, prerequisitos: [] },
      { sigla: "EFI200", nombre: "EDUCACIÓN FÍSICA I", semestre: 1, creditos: 2, prerequisitos: [] },
      { sigla: "FIS100", nombre: "INTRODUCCIÓN A LA FÍSICA", semestre: 1, creditos: 6, prerequisitos: [] },
      { sigla: "INF129", nombre: "INTRODUCCIÓN A LA PROGRAMACIÓN", semestre: 1, creditos: 7, prerequisitos: [] },
      { sigla: "MAT070", nombre: "INTRODUCCIÓN AL CÁLCULO", semestre: 1, creditos: 6, prerequisitos: [] },
      
      // Semestre 2 (30 créditos - 6 ramos)
      { sigla: "MAT061", nombre: "ÁLGEBRA LINEAL", semestre: 2, creditos: 6, prerequisitos: ["MAT060"] },
      { sigla: "MAT071", nombre: "CÁLCULO EN UNA VARIABLE", semestre: 2, creditos: 6, prerequisitos: ["MAT070"] },
      { sigla: "HXW007", nombre: "COMUNICACIÓN EFECTIVA II", semestre: 2, creditos: 3, prerequisitos: ["HXW006"] },
      { sigla: "EFI201", nombre: "EDUCACIÓN FÍSICA II", semestre: 2, creditos: 2, prerequisitos: ["EFI200"] },
      { sigla: "FIS111", nombre: "FÍSICA GENERAL MECÁNICA", semestre: 2, creditos: 6, prerequisitos: ["FIS100"] },
      { sigla: "IWG400", nombre: "PROYECTO INICIAL", semestre: 2, creditos: 7, prerequisitos: [] },
      
      // Semestre 3 (30 créditos - 6 ramos)
      { sigla: "AUX200", nombre: "ADMINISTRACIÓN Y SOSTENIBILIDAD", semestre: 3, creditos: 4, prerequisitos: [] },
      { sigla: "HXW008", nombre: "ANÁLISIS CRÍTICO DE TEXTO", semestre: 3, creditos: 3, prerequisitos: ["HXW007"] },
      { sigla: "MAT081", nombre: "CÁLCULO EN VARIAS VARIABLES", semestre: 3, creditos: 6, prerequisitos: ["MAT071"] },
      { sigla: "FIS112", nombre: "CALOR Y ONDAS", semestre: 3, creditos: 6, prerequisitos: ["FIS111"] },
      { sigla: "INF132", nombre: "MATEMÁTICA DISCRETA", semestre: 3, creditos: 5, prerequisitos: ["INF129", "MAT070", "MAT061"] },
      { sigla: "INF131", nombre: "PROGRAMACIÓN AVANZADA", semestre: 3, creditos: 6, prerequisitos: ["INF129"] },
      
      // Semestre 4 (30 créditos - 6 ramos)
      { sigla: "HXW009", nombre: "COMUNICACIÓN EFECTIVA III", semestre: 4, creditos: 3, prerequisitos: ["HXW007"] },
      { sigla: "MAT053", nombre: "ECUACIONES DIFERENCIALES", semestre: 4, creditos: 5, prerequisitos: ["MAT081"] },
      { sigla: "FIS114", nombre: "ELECTRICIDAD Y MAGNETISMO", semestre: 4, creditos: 6, prerequisitos: ["FIS112"] },
      { sigla: "INF135", nombre: "ESTADÍSTICA COMPUTACIONAL", semestre: 4, creditos: 6, prerequisitos: ["MAT081", "INF129"] },
      { sigla: "INF133", nombre: "ESTRUCTURA DE DATOS", semestre: 4, creditos: 6, prerequisitos: ["INF131"] },
      { sigla: "AUX201", nombre: "INGENIERÍA ECONÓMICA", semestre: 4, creditos: 4, prerequisitos: ["INF129"] },
      
      // Semestre 5 (30 créditos - 6 ramos)
      { sigla: "INF140", nombre: "ARQUITECTURA DE COMPUTADORES", semestre: 5, creditos: 5, prerequisitos: ["INF133"] },
      { sigla: "INF138", nombre: "BASES DE DATOS", semestre: 5, creditos: 5, prerequisitos: ["INF133"] },
      { sigla: "INF142", nombre: "INGENIERÍA Y SOCIEDAD", semestre: 5, creditos: 5, prerequisitos: ["IWG400"] },
      { sigla: "INF229", nombre: "OPTIMIZACIÓN", semestre: 5, creditos: 5, prerequisitos: ["INF129", "MAT061"] },
      { sigla: "INF141", nombre: "PARADIGMAS DE PROGRAMACIÓN", semestre: 5, creditos: 5, prerequisitos: ["INF133"] },
      { sigla: "INF143", nombre: "AUTÓMATAS Y LENGUAJES FORMALES", semestre: 5, creditos: 5, prerequisitos: ["INF132"] },
      
      // Semestre 6 (30 créditos - 6 ramos)
      { sigla: "INF144", nombre: "ALGORITMOS Y COMPLEJIDAD", semestre: 6, creditos: 6, prerequisitos: ["INF133"] },
      { sigla: "INF146", nombre: "ANÁLISIS Y DISEÑO DE SOFTWARE", semestre: 6, creditos: 5, prerequisitos: ["INF141", "INF138"] },
      { sigla: "INF147", nombre: "COMPUTACIÓN CIENTÍFICA", semestre: 6, creditos: 6, prerequisitos: ["MAT053", "INF133"] },
      { sigla: "HXW012", nombre: "COMUNICACIÓN EFECTIVA IV", semestre: 6, creditos: 3, prerequisitos: ["HXW009"] },
      { sigla: "INF148", nombre: "INVESTIGACIÓN DE OPERACIONES", semestre: 6, creditos: 5, prerequisitos: ["INF135", "INF229"] },
      { sigla: "INF145", nombre: "SISTEMAS OPERATIVOS", semestre: 6, creditos: 5, prerequisitos: ["INF140"] },
      
      // Semestre 7 (30 créditos - 6 ramos)
      { sigla: "INF158", nombre: "CIENCIA DE DATOS", semestre: 7, creditos: 5, prerequisitos: ["INF133", "INF146"] },
      { sigla: "INF156", nombre: "INGENIERÍA DE SOFTWARE", semestre: 7, creditos: 5, prerequisitos: ["INF146"] },
      { sigla: "AUX", nombre: "INGLÉS DISCIPLINAR", semestre: 7, creditos: 3, prerequisitos: ["HXW012"] },
      { sigla: "INF157", nombre: "INTELIGENCIA ARTIFICIAL I", semestre: 7, creditos: 6, prerequisitos: ["INF147"] },
      { sigla: "INF154", nombre: "REDES Y CIBERSEGURIDAD", semestre: 7, creditos: 6, prerequisitos: ["INF140"] },
      { sigla: "INF153", nombre: "TEORÍA DE SISTEMAS", semestre: 7, creditos: 5, prerequisitos: ["MAT053", "INF143"] },
      
      // Semestre 8 (30 créditos - 6 ramos)
      { sigla: "INF165", nombre: "DISEÑO UX", semestre: 8, creditos: 5, prerequisitos: ["INF146"] },
      { sigla: "AUX219", nombre: "ELECTIVO", semestre: 8, creditos: 5, prerequisitos: [] },
      { sigla: "INF166", nombre: "INTELIGENCIA ARTIFICIAL II", semestre: 8, creditos: 5, prerequisitos: ["INF157", "INF158"] },
      { sigla: "INF163", nombre: "PROYECTO DE INGENIERÍA", semestre: 8, creditos: 5, prerequisitos: ["INF147", "INF144"] },
      { sigla: "INF164", nombre: "SISTEMAS DISTRIBUIDOS", semestre: 8, creditos: 5, prerequisitos: ["INF145", "INF154"] },
      { sigla: "INF167", nombre: "SISTEMAS ORGANIZACIONALES", semestre: 8, creditos: 5, prerequisitos: ["INF142"] },
      
      // Semestre 9 (30 créditos - 5 ramos)
      { sigla: "AUX222", nombre: "ELECTIVO", semestre: 9, creditos: 5, prerequisitos: [] },
      { sigla: "INF170", nombre: "ELECTIVO DISCIPLINAR 1", semestre: 9, creditos: 6, prerequisitos: [] },
      { sigla: "INF169", nombre: "ELECTIVO DISCIPLINAR 2", semestre: 9, creditos: 6, prerequisitos: [] },
      { sigla: "INF171", nombre: "ELECTIVO DISCIPLINAR 3", semestre: 9, creditos: 6, prerequisitos: [] },
      { sigla: "INF168", nombre: "GESTIÓN PROYECTOS INF.", semestre: 9, creditos: 7, prerequisitos: [] },
      
      // Semestre 10 (30 créditos - 4 ramos) - CORREGIDO
      { sigla: "INF540", nombre: "ELECTIVO DISCIPLINAR 4", semestre: 10, creditos: 6, prerequisitos: [] },
      { sigla: "INF541", nombre: "ELECTIVO DISCIPLINAR 5", semestre: 10, creditos: 6, prerequisitos: [] },
      { sigla: "INF539", nombre: "TALLER DE TITULACIÓN", semestre: 10, creditos: 8, prerequisitos: ["INF164", "INF166"] },
      { sigla: "INF538", nombre: "TALLER DE DESARROLLO DE PROYECTOS DE INFORMÁTICA", semestre: 10, creditos: 10, prerequisitos: ["INF168", "INF539"] }
    ];

    const mallaContainer = document.getElementById("malla-container");
    let estadoAsignaturas = JSON.parse(localStorage.getItem("estadoMalla")) || {};

    function renderizarMalla() {
      mallaContainer.innerHTML = "";
      
      // Agrupar asignaturas por semestre
      const semestres = {};
      mallaCompleta.forEach(asignatura => {
        if (!semestres[asignatura.semestre]) {
          semestres[asignatura.semestre] = [];
        }
        semestres[asignatura.semestre].push(asignatura);
      });
      
      // Crear sección para cada semestre
      for (const [numeroSemestre, asignaturas] of Object.entries(semestres)) {
        const semestreDiv = document.createElement("div");
        semestreDiv.className = "semestre";
        
        const header = document.createElement("div");
        header.className = "semestre-header";
        header.textContent = `Semestre ${numeroSemestre}`;
        semestreDiv.appendChild(header);
        
        const grid = document.createElement("div");
        grid.className = "malla-grid";
        
        asignaturas.forEach(asignatura => {
          const asignaturaDiv = document.createElement("div");
          asignaturaDiv.className = "asignatura";
          
          // Determinar estado actual
          const estadoActual = estadoAsignaturas[asignatura.sigla] || "pendiente";
          const prerequisitosCumplidos = asignatura.prerequisitos.every(
            prereq => estadoAsignaturas[prereq] === "aprobado"
          );
          
          // Aplicar clase de estado
          if (estadoActual === "aprobado") {
            asignaturaDiv.classList.add("aprobado");
          } else if (estadoActual === "cursando") {
            asignaturaDiv.classList.add("cursando");
          } else if (!prerequisitosCumplidos) {
            asignaturaDiv.classList.add("bloqueado");
          } else {
            asignaturaDiv.classList.add("pendiente");
          }
          
          // Crear contenido de la asignatura
          asignaturaDiv.innerHTML = `
            <h3>${asignatura.sigla} - ${asignatura.nombre}</h3>
            <div class="creditos">${asignatura.creditos} cr.</div>
            <p>Semestre ${asignatura.semestre}</p>
            <div class="prerequisitos">
              ${asignatura.prerequisitos.length > 0 ? 
                `Prerrequisitos: ${asignatura.prerequisitos.join(", ")}` : 
                "Sin prerrequisitos"}
            </div>
            <div class="estado-botones">
              <button class="estado-btn btn-aprobado" data-sigla="${asignatura.sigla}" data-estado="aprobado">✓</button>
              <button class="estado-btn btn-cursando" data-sigla="${asignatura.sigla}" data-estado="cursando">~</button>
              <button class="estado-btn btn-pendiente" data-sigla="${asignatura.sigla}" data-estado="pendiente">✗</button>
            </div>
          `;
          
          grid.appendChild(asignaturaDiv);
        });
        
        semestreDiv.appendChild(grid);
        mallaContainer.appendChild(semestreDiv);
      }
      
      actualizarEstadisticas();
      
      // Agregar event listeners a los botones
      document.querySelectorAll(".estado-btn").forEach(boton => {
        boton.addEventListener("click", function() {
          const sigla = this.getAttribute("data-sigla");
          const nuevoEstado = this.getAttribute("data-estado");
          
          estadoAsignaturas[sigla] = nuevoEstado;
          localStorage.setItem("estadoMalla", JSON.stringify(estadoAsignaturas));
          
          renderizarMalla();
        });
      });
    }
    
    function actualizarEstadisticas() {
      const totalAsignaturas = mallaCompleta.length;
      const asignaturasAprobadas = mallaCompleta.filter(
        a => estadoAsignaturas[a.sigla] === "aprobado"
      ).length;
      
      const creditosTotales = 300;
      const creditosAprobados = mallaCompleta.reduce((total, a) => {
        return estadoAsignaturas[a.sigla] === "aprobado" ? total + a.creditos : total;
      }, 0);
      
      // Calcular porcentajes
      const porcentajeAsignaturas = Math.round((asignaturasAprobadas / totalAsignaturas) * 100);
      const porcentajeCreditos = Math.round((creditosAprobados / creditosTotales) * 100);
      
      // Actualizar DOM
      document.getElementById("asignaturas-totales").textContent = `Total asignaturas: ${totalAsignaturas}`;
      document.getElementById("asignaturas-aprobadas").textContent = 
        `Aprobadas: ${asignaturasAprobadas} (${porcentajeAsignaturas}%)`;
      
      document.getElementById("creditos-totales").textContent = `Créditos totales: ${creditosTotales}`;
      document.getElementById("creditos-aprobados").textContent = 
        `Aprobados: ${creditosAprobados} (${porcentajeCreditos}%)`;
      
      document.getElementById("progreso-bar").style.width = `${porcentajeCreditos}%`;
      document.getElementById("progreso-texto").textContent = `${porcentajeCreditos}% completado`;
    }
    
    // Inicializar
    renderizarMalla();
  </script>
</body>
</html>